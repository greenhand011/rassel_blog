---
title: 'ä»é›¶å¼€å§‹çš„æœºå™¨å­¦ä¹ å®æˆ˜ï¼šæ³¢å£«é¡¿æˆ¿ä»·é¢„æµ‹ä¸å›å½’åˆ†æ'
date: '2025-12-28'
tags: [AI Security']
draft: false
summary: 'ç»§æœºå™¨å­¦ä¹ å…¨æ™¯æŒ‡å—åï¼Œæœ¬æ–‡ä»¥ç»å…¸çš„â€œæˆ¿ä»·é¢„æµ‹â€é¡¹ç›®ä¸ºä¾‹ï¼Œæ‰‹æŠŠæ‰‹å¸¦ä½ ç»å†æ•°æ®æ¸…æ´—ã€ç‰¹å¾å·¥ç¨‹ã€çº¿æ€§å›å½’åˆ°éšæœºæ£®æ—çš„å®Œæ•´å®æˆ˜æµç¨‹ã€‚'
---

## å‰è¨€

çœ‹å®Œäº†ä¸Šä¸€ç¯‡æœºå™¨å­¦ä¹ å…¨æ™¯æŒ‡å—ï¼Œä½ å¯èƒ½å·²ç»å¯¹å„ç§ç®—æ³•è·ƒè·ƒæ¬²è¯•ã€‚ä¸ºäº†æ·±å…¥ç†è§£è¿™äº›**ç›‘ç£å­¦ä¹ **ç®—æ³•ï¼Œå…‰çœ‹ä¸ç»ƒæ˜¯å‡æŠŠå¼ã€‚

ä»Šå¤©ï¼Œæˆ‘ä»¬ä»¥æ•°æ®ç§‘å­¦é¢†åŸŸæœ€ç»å…¸çš„å…¥é—¨é¡¹ç›®â€”â€”**æˆ¿ä»·é¢„æµ‹**ä¸ºä¸»é¢˜ï¼Œç»“åˆå¤šä¸ªç®—æ³•æ¥è¿›è¡Œæ¯”è¾ƒå’Œè¯„ä¼°ã€‚æˆ‘ä»¬å°†ä»æœ€åŸå§‹çš„æ•°æ®å¼€å§‹ï¼Œä¸€æ­¥æ­¥æ„å»ºå‡ºèƒ½ç²¾å‡†é¢„æµ‹æˆ¿ä»·çš„ AI æ¨¡å‹ã€‚

**é¡¹ç›®åç§°**ï¼šæˆ¿ä»·é¢„æµ‹ä¸å›å½’åˆ†æ

**æ ¸å¿ƒæ­¥éª¤é¢„è§ˆ**ï¼š

1.  **æ•°æ®é¢„å¤„ç†**ï¼šå¤„ç†ç¼ºå¤±å€¼ã€æ¸…æ´—è„æ•°æ®ã€‚
2.  **ç‰¹å¾å·¥ç¨‹**ï¼šå°†æ–‡æœ¬è½¬åŒ–ä¸ºæ¨¡å‹èƒ½è¯»æ‡‚çš„æ•°å­—ã€‚
3.  **æ¨¡å‹å»ºç«‹**ï¼šä»çº¿æ€§å›å½’èµ·æ­¥ï¼Œè¿‡æ¸¡åˆ°éšæœºæ£®æ—ã€‚
4.  **ç»“æœåˆ†æ**ï¼šå¯è§†åŒ–ç‰¹å¾é‡è¦æ€§ï¼Œç”Ÿæˆæäº¤æ–‡ä»¶ã€‚

---

## ä¸€ã€åˆè¯†æ•°æ®ï¼šçŸ¥å·±çŸ¥å½¼

é¦–å…ˆï¼Œæˆ‘ä»¬è¦éªŒè¯æ•°æ®æ˜¯å¦èƒ½æ­£ç¡®è¯»å–ï¼Œå¹¶å¯¹æ•°æ®çš„è§„æ¨¡æœ‰ä¸ªç›´è§‚çš„æ¦‚å¿µã€‚

```python
# å¯¼å…¥å¿…è¦çš„åº“
import pandas as pd
import numpy as np

# 1. è¯»å–æ•°æ®
# ç¡®ä¿csvæ–‡ä»¶å’Œä½ çš„ä»£ç åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œæˆ–è€…å¡«å†™ç»å¯¹è·¯å¾„
train_df = pd.read_csv('train.csv')
test_df = pd.read_csv('test.csv')

# 2. æŸ¥çœ‹æ•°æ®è§„æ¨¡ (è¡Œæ•°, åˆ—æ•°)
print(f"è®­ç»ƒé›†è§„æ¨¡ (è¡Œ, åˆ—): {train_df.shape}")
print(f"æµ‹è¯•é›†è§„æ¨¡ (è¡Œ, åˆ—): {test_df.shape}")

# 3. æŸ¥çœ‹å‰å‡ è¡Œæ•°æ®ï¼Œç›´è§‚æ„Ÿå—ä¸€ä¸‹
print("\nè®­ç»ƒé›†å‰5è¡Œæ•°æ®ï¼š")
# display(train_df.head()) # å¦‚æœæ˜¯åœ¨Jupyter Notebookä¸­ç”¨è¿™å°±è¡Œ
print(train_df.head())

# 4. æŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬è¦é¢„æµ‹çš„ç›®æ ‡åˆ—æ˜¯ä»€ä¹ˆï¼ˆé€šå¸¸æ˜¯ SalePriceï¼‰
print("\nç›®æ ‡åˆ—ï¼ˆæˆ¿ä»·ï¼‰ç»Ÿè®¡ä¿¡æ¯ï¼š")
print(train_df['SalePrice'].describe())
```

<img
  src="/static/images/house-prices-advanced-regression-techniques/dataset.png"
  alt="æ•°æ®é›†é¢„è§ˆï¼Œå±•ç¤ºäº†æ•°æ®çš„è¡Œåˆ—æ•°ä»¥åŠå‰äº”è¡Œå…·ä½“å†…å®¹"
  width="700"
/>

---

## äºŒã€æ•°æ®é¢„å¤„ç†ï¼šå¡«è¡¥ç¼ºå¤±çš„æ‹¼å›¾

çœŸå®ä¸–ç•Œçš„æ•°æ®å¾€å¾€æ˜¯ä¸å®Œæ•´çš„ã€‚ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬è¦è¯†åˆ«å¹¶å¤„ç†è¿™äº›â€œç©ºæ´â€ã€‚

### 1. è¯†åˆ«ç¼ºå¤±å€¼

```python
print("\n--- ç¼ºå¤±å€¼å¤„ç† ---")

# 1. æŸ¥çœ‹è®­ç»ƒé›†ç¼ºå¤±å€¼æƒ…å†µ
# è®¡ç®—æ¯åˆ—çš„ç¼ºå¤±å€¼æ•°é‡
missing_train = train_df.isnull().sum()
# è¿‡æ»¤æ‰æ²¡æœ‰ç¼ºå¤±å€¼çš„åˆ—ï¼Œå¹¶æŒ‰ç¼ºå¤±å€¼æ•°é‡é™åºæ’åˆ—
missing_train = missing_train[missing_train > 0].sort_values(ascending=False)
print("\nè®­ç»ƒé›†ç¼ºå¤±å€¼ç»Ÿè®¡ï¼š")
print(missing_train)
print(f"è®­ç»ƒé›†å…±æœ‰ {len(missing_train)} åˆ—æœ‰ç¼ºå¤±å€¼ã€‚")

# 2. æŸ¥çœ‹æµ‹è¯•é›†ç¼ºå¤±å€¼æƒ…å†µ
missing_test = test_df.isnull().sum()
missing_test = missing_test[missing_test > 0].sort_values(ascending=False)
print("\næµ‹è¯•é›†ç¼ºå¤±å€¼ç»Ÿè®¡ï¼š")
print(missing_test)
print(f"æµ‹è¯•é›†å…±æœ‰ {len(missing_test)} åˆ—æœ‰ç¼ºå¤±å€¼ã€‚")

# 3. è®¡ç®—ç¼ºå¤±å€¼æ¯”ä¾‹
missing_train_percent = (train_df.isnull().sum() / len(train_df)) * 100
missing_train_percent = missing_train_percent[missing_train_percent > 0].sort_values(ascending=False)
print("\nè®­ç»ƒé›†ç¼ºå¤±å€¼ç™¾åˆ†æ¯”ï¼š")
print(missing_train_percent)
```

<img
  src="/static/images/house-prices-advanced-regression-techniques/null.png"
  alt="ç¼ºå¤±å€¼ç»Ÿè®¡åˆ—è¡¨ï¼Œæ˜¾ç¤ºäº†å„ç‰¹å¾åˆ—ç¼ºå¤±æ•°æ®çš„æ•°é‡å’Œç™¾åˆ†æ¯”"
  width="700"
/>

### 2. å¡«å……ç­–ç•¥

é€šè¿‡æŸ¥çœ‹æ•°æ®çš„è¯´æ˜æ–‡æ¡£ï¼ˆData Descriptionï¼‰å’Œç»Ÿè®¡ç»“æœï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªæå…¶é‡è¦çš„è§„å¾‹ï¼šç»å¤§å¤šæ•°çš„â€œç¼ºå¤±å€¼â€å…¶å®å¹¶ä¸æ˜¯æ•°æ®ä¸¢å¤±ï¼Œè€Œæ˜¯ä»£è¡¨**â€œæ²¡æœ‰è¯¥è®¾æ–½â€**ã€‚

æˆ‘ä»¬éœ€è¦æ ¹æ®ç‰¹å¾çš„æ€§è´¨ï¼Œé‡‡ç”¨ä¸‰ç±»ä¸åŒçš„å¡«å……ç­–ç•¥ï¼š

1.  **ç±»åˆ«å‹ç‰¹å¾ï¼ˆå®é™…å«ä¹‰æ˜¯"æ— "ï¼‰**ï¼šä¾‹å¦‚ `PoolQC`ï¼ˆæ³³æ± è´¨é‡ï¼‰ä¸ºç©ºï¼Œå®é™…ä¸Šä»£è¡¨è¿™æˆ¿å­**æ²¡æ³³æ± **ã€‚è¿™ç±»æˆ‘ä»¬å¡«å……å­—ç¬¦ä¸² `"None"`ã€‚
2.  **æ•°å€¼å‹ç‰¹å¾ï¼ˆå®é™…å«ä¹‰æ˜¯0ï¼‰**ï¼šå¦‚æœæ²¡è½¦åº“ï¼Œé‚£ä¹ˆ `GarageArea`ï¼ˆè½¦åº“é¢ç§¯ï¼‰è‡ªç„¶åº”è¯¥æ˜¯ `0`ã€‚
3.  **çœŸæ­£ç¼ºå¤±çš„æ•°æ®**ï¼šä¾‹å¦‚ `LotFrontage`ï¼ˆä¸´è¡—å®½åº¦ï¼‰ï¼Œæˆ¿å­ä¸å¯èƒ½æ²¡æœ‰è¡—é“å®½åº¦ã€‚å¯¹äºè¿™ç±»æ•°æ®ï¼Œæˆ‘ä»¬ç”¨è¯¥åˆ—çš„**ä¸­ä½æ•°**æˆ–**ä¼—æ•°**æ¥å¡«å……ï¼Œä»¥ä¿æŒæ•°æ®çš„åˆ†å¸ƒç‰¹æ€§ã€‚

```python
print("\n--- å¼€å§‹å¡«å……ç¼ºå¤±å€¼ ---")

# ä¸ºäº†æ–¹ä¾¿å¤„ç†ï¼Œæˆ‘ä»¬æŠŠè®­ç»ƒé›†å’Œæµ‹è¯•é›†æ”¾åœ¨ä¸€ä¸ªåˆ—è¡¨é‡Œå¾ªç¯å¤„ç†
combine = [train_df, test_df]

for dataset in combine:
    # ---------------------------------------------------------
    # ç¬¬ä¸€ç±»ï¼šå¡«å…… "None" (æ ¹æ®è¯´æ˜ä¹¦ï¼ŒNAä»£è¡¨â€œæ²¡æœ‰è¿™ä¸ªè®¾æ–½â€)
    # ---------------------------------------------------------
    # æ³³æ± ã€å··å­ã€æ‚é¡¹ã€å›´æ ã€å£ç‚‰
    cols_none = ['PoolQC', 'MiscFeature', 'Alley', 'Fence', 'FireplaceQu']
    for col in cols_none:
        dataset[col] = dataset[col].fillna("None")

    # è½¦åº“ç›¸å…³ï¼ˆç±»åˆ«å‹å¡«Noneï¼Œæ•°å€¼å‹å¡«0ï¼‰
    dataset['GarageType'] = dataset['GarageType'].fillna("None")
    dataset['GarageFinish'] = dataset['GarageFinish'].fillna("None")
    dataset['GarageQual'] = dataset['GarageQual'].fillna("None")
    dataset['GarageCond'] = dataset['GarageCond'].fillna("None")

    dataset['GarageYrBlt'] = dataset['GarageYrBlt'].fillna(0)
    dataset['GarageArea'] = dataset['GarageArea'].fillna(0)
    dataset['GarageCars'] = dataset['GarageCars'].fillna(0)

    # åœ°ä¸‹å®¤ç›¸å…³ï¼ˆåŸç†åŒä¸Šï¼‰
    bsmt_str_cols = ['BsmtQual', 'BsmtCond', 'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2']
    for col in bsmt_str_cols:
        dataset[col] = dataset[col].fillna("None")

    bsmt_num_cols = ['TotalBsmtSF', 'BsmtUnfSF', 'BsmtFinSF1', 'BsmtFinSF2', 'BsmtFullBath', 'BsmtHalfBath']
    for col in bsmt_num_cols:
        dataset[col] = dataset[col].fillna(0)

    # ç –çŸ³è´´é¢ (MasVnr)
    dataset["MasVnrType"] = dataset["MasVnrType"].fillna("None")
    dataset["MasVnrArea"] = dataset["MasVnrArea"].fillna(0)

    # ---------------------------------------------------------
    # ç¬¬äºŒç±»ï¼šå¡«å……ä¸­ä½æ•° (çœŸçš„ç¼ºå¤±çš„æ•°æ®)
    # ---------------------------------------------------------
    # LotFrontage ä¸´è¡—å®½åº¦ï¼Œç”¨ä¸­ä½æ•°å¡«å……
    dataset['LotFrontage'] = dataset['LotFrontage'].fillna(dataset['LotFrontage'].median())

    # ---------------------------------------------------------
    # ç¬¬ä¸‰ç±»ï¼šå¡«å……ä¼—æ•° (ç¼ºå¤±å¾ˆå°‘ï¼Œç”¨å‡ºç°æœ€å¤šçš„å€¼å¡«å……)
    # ---------------------------------------------------------
    cols_mode = ['MSZoning', 'Electrical', 'KitchenQual', 'Exterior1st', 'Exterior2nd', 'SaleType', 'Utilities', 'Functional']
    for col in cols_mode:
        dataset[col] = dataset[col].fillna(dataset[col].mode()[0])

# --- éªŒè¯æ˜¯å¦è¿˜æœ‰ç¼ºå¤±å€¼ ---
print("\nå¡«å……åæ£€æŸ¥ï¼š")
print(f"è®­ç»ƒé›†å‰©ä½™ç¼ºå¤±å€¼æ€»æ•°: {train_df.isnull().sum().sum()}")
print(f"æµ‹è¯•é›†å‰©ä½™ç¼ºå¤±å€¼æ€»æ•°: {test_df.isnull().sum().sum()}")
```

<img
  src="/static/images/house-prices-advanced-regression-techniques/fixnull.png"
  alt="ç¼ºå¤±å€¼ä¿®å¤å®Œæˆåçš„æ£€æŸ¥è¾“å‡ºï¼Œæ˜¾ç¤ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ç¼ºå¤±å€¼æ€»æ•°å‡ä¸º0"
  width="700"
/>

---

## ä¸‰ã€ç‰¹å¾å·¥ç¨‹ï¼šè®©æ•°æ®â€œè¯´â€æœºå™¨è¯­è¨€

ç°åœ¨æ•°æ®è™½ç„¶å®Œæ•´äº†ï¼Œä½†è®¡ç®—æœºåªè®¤è¯†æ•°å­—ï¼Œä¸è®¤è¯†å•è¯ã€‚æ¯”å¦‚å®ƒæ— æ³•ç†è§£ `MSZoning` åˆ—ä¸­çš„ `RL`ï¼ˆä½å¯†åº¦ä½å®…åŒºï¼‰æ˜¯ä»€ä¹ˆæ„æ€ã€‚

æˆ‘ä»¬éœ€è¦é€šè¿‡**ç‹¬çƒ­ç¼–ç  (One-Hot Encoding)** å°†è¿™äº›æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—ã€‚

> **ğŸ’¡ åŸç†è®²è§£**ï¼š
> åœ¨æ•°å­¦å…¬å¼ $y = ax + b$ ä¸­ï¼Œæˆ‘ä»¬æ— æ³•è®¡ç®— `'RL' * 5`ã€‚
> ç‹¬çƒ­ç¼–ç ä¼šå°† `MSZoning` è¿™ä¸€åˆ—æ‹†åˆ†æˆå¤šä¸ªæ–°åˆ—ï¼Œä¾‹å¦‚ `MSZoning_RL`ã€‚å¦‚æœæ˜¯è¯¥ç±»å‹ï¼Œå€¼ä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚è¿™æ ·æ–‡æœ¬å°±å˜æˆäº†æœºå™¨å¯è®¡ç®—çš„ 0 å’Œ 1ã€‚

**æ³¨æ„**ï¼šä¸ºäº†ä¿è¯è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç‰¹å¾åˆ—å®Œå…¨ä¸€è‡´ï¼ˆå¯¹é½ï¼‰ï¼Œæˆ‘ä»¬é€šå¸¸å…ˆå°†ä¸¤è€…åˆå¹¶ï¼Œå¤„ç†å®Œåå†åˆ†å¼€ã€‚

```python
print("\n--- ç‰¹å¾å·¥ç¨‹ï¼šæ•°å­—åŒ–ä¸å¯¹é½ ---")

# 1. å¤‡ä»½å¹¶åˆ é™¤ Id åˆ— (Idåªæ˜¯ç´¢å¼•ï¼Œä¸æ˜¯ç‰¹å¾)
test_id = test_df['Id']
train_df.drop('Id', axis=1, inplace=True)
test_df.drop('Id', axis=1, inplace=True)

# 2. å–å‡ºç›®æ ‡å˜é‡ (æˆ¿ä»· SalePrice)
y_train = train_df['SalePrice']
X_train_raw = train_df.drop('SalePrice', axis=1)

# 3. åˆå¹¶è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç‰¹å¾
all_data = pd.concat([X_train_raw, test_df], axis=0)
print(f"åˆå¹¶åçš„æ•°æ®è§„æ¨¡: {all_data.shape}")

# 4. ç‹¬çƒ­ç¼–ç  (æŠŠæ–‡æœ¬å˜æˆæ•°å­—)
all_data = pd.get_dummies(all_data)
print(f"ç¼–ç åçš„æ•°æ®è§„æ¨¡: {all_data.shape}")

# 5. é‡æ–°æ‹†åˆ†å›è®­ç»ƒé›†å’Œæµ‹è¯•é›†
X_train = all_data.iloc[:len(train_df), :]
X_test = all_data.iloc[len(train_df):, :]

print("\nå¤„ç†å®Œæˆï¼")
print(f"æœ€ç»ˆè®­ç»ƒé›†ç‰¹å¾ç»´åº¦ X_train: {X_train.shape}")
print(f"æœ€ç»ˆæµ‹è¯•é›†ç‰¹å¾ç»´åº¦ X_test:  {X_test.shape}")
```

<img
  src="/static/images/house-prices-advanced-regression-techniques/process.png"
  alt="æ•°æ®é¢„å¤„ç†åçš„ç»´åº¦å±•ç¤ºï¼Œæ˜¾ç¤ºç‰¹å¾æ•°é‡å› ä¸ºç‹¬çƒ­ç¼–ç è€Œæ˜¾è‘—å¢åŠ "
  width="700"
/>

---

## å››ã€æ¨¡å‹å»ºç«‹ï¼šä»çº¿æ€§å›å½’å¼€å§‹

### 1. åˆ’åˆ†éªŒè¯é›†ä¸åŸºå‡†æ¨¡å‹

æˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„**çº¿æ€§å›å½’ (Linear Regression)** å¼€å§‹ã€‚

> **ğŸ’¡ åŸç†è®²è§£**ï¼š
> çº¿æ€§å›å½’å‡è®¾æˆ¿ä»·å’Œç‰¹å¾ä¹‹é—´å­˜åœ¨çº¿æ€§å…³ç³»ï¼ˆä¾‹å¦‚ï¼š`æˆ¿ä»· = w1 * é¢ç§¯ + w2 * æˆ¿é—´æ•° + ... + b`ï¼‰ã€‚
>
> ä¸ºäº†éªŒè¯æ¨¡å‹åœ¨æœªçŸ¥æ•°æ®ä¸Šçš„è¡¨ç°ï¼Œæˆ‘ä»¬ä¸èƒ½æŠŠæ‰€æœ‰è®­ç»ƒé›†éƒ½ç”¨æ¥è®­ç»ƒï¼Œå¿…é¡»ç•™å‡ºä¸€éƒ¨åˆ†ï¼ˆé€šå¸¸ 20%ï¼‰ä½œä¸º**éªŒè¯é›† (Validation Set)**ã€‚è¿™å°±åƒå¹³æ—¶åšä½œä¸šï¼ˆè®­ç»ƒé›†ï¼‰å’ŒæœŸä¸­è€ƒè¯•ï¼ˆéªŒè¯é›†ï¼‰çš„åŒºåˆ«ã€‚

```python
print("\n--- æ¨¡å‹å»ºç«‹ï¼šçº¿æ€§å›å½’ ---")

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

# 1. åˆ‡åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›† (8:2)
X_tr, X_val, y_tr, y_val = train_test_split(X_train, y_train, test_size=0.2, random_state=42)

# 2. åˆå§‹åŒ–å¹¶è®­ç»ƒæ¨¡å‹
model_lr = LinearRegression()
model_lr.fit(X_tr, y_tr)

# 3. åœ¨éªŒè¯é›†ä¸Šé¢„æµ‹
predictions = model_lr.predict(X_val)

# 4. è¯„ä¼°æ¨¡å‹è¡¨ç° (è®¡ç®— RMSE)
rmse = np.sqrt(mean_squared_error(y_val, predictions))
print(f"\nçº¿æ€§å›å½’æ¨¡å‹çš„å‡æ–¹æ ¹è¯¯å·® (RMSE): {rmse:.2f}")

# 5. ç›´è§‚å¯¹æ¯”
comparison = pd.DataFrame({"çœŸå®å€¼": y_val[:5].values, "é¢„æµ‹å€¼": predictions[:5]})
print(comparison)
```

<img
  src="/static/images/house-prices-advanced-regression-techniques/l_result1.png"
  alt="çº¿æ€§å›å½’æ¨¡å‹çš„é¢„æµ‹ç»“æœå¯¹æ¯”ï¼ŒRMSE è¯¯å·®è¾ƒå¤§"
  width="700"
/>

**ç»“æœåˆ†æ**ï¼šRMSE çº¦ä¸º 65,389ã€‚è€ƒè™‘åˆ°æˆ¿ä»·ä¸­ä½æ•°çº¦ 16 ä¸‡ï¼Œè¿™ä¸ªè¯¯å·®å¾ˆå¤§ã€‚åŸå› æ˜¯æ™®é€šçš„çº¿æ€§å›å½’å®¹æ˜“å—åˆ°å¼‚å¸¸å€¼å’Œç‰¹å¾è¿‡å¤šçš„å½±å“ï¼ˆè¿‡æ‹Ÿåˆï¼‰ï¼Œä¸”æ— æ³•æ•æ‰éçº¿æ€§å…³ç³»ã€‚

### 2. è¿›é˜¶ç®—æ³•ï¼šRidge ä¸ éšæœºæ£®æ—

ä¸ºäº†é™ä½è¯¯å·®ï¼Œæˆ‘ä»¬å¼•å…¥ä¸¤ä¸ªæ›´å¼ºå¤§çš„ç®—æ³•ï¼š

1.  **Ridge å›å½’ (å²­å›å½’)**ï¼šåœ¨çº¿æ€§å›å½’çš„åŸºç¡€ä¸Šå¢åŠ äº†â€œæƒ©ç½šé¡¹â€ï¼Œé˜²æ­¢æ¨¡å‹å¯¹æŸäº›ç‰¹å¾è¿‡äºæ•æ„Ÿï¼Œé²æ£’æ€§æ›´å¼ºã€‚
2.  **éšæœºæ£®æ— (Random Forest)**ï¼šè¿™æ˜¯ä¸€ç§éçº¿æ€§æ¨¡å‹ï¼Œç”±æˆç™¾ä¸Šåƒæ£µå†³ç­–æ ‘ç»„æˆã€‚å®ƒèƒ½å¾ˆå¥½åœ°æ•æ‰å¤æ‚çš„éçº¿æ€§å…³ç³»ï¼ˆæ¯”å¦‚ï¼šæˆ¿å­å¤ªæ—§ä¹Ÿä¸è¡Œï¼Œä½†å¦‚æœæ˜¯å¤è‘£å»ºç­‘åè€Œè´µï¼‰ã€‚

```python
print("\n--- æ¨¡å‹è¿›é˜¶ï¼šç®—æ³•å¯¹æ¯” ---")

from sklearn.linear_model import Ridge
from sklearn.ensemble import RandomForestRegressor

# 1. Ridge å›å½’
model_ridge = Ridge(alpha=10)
model_ridge.fit(X_tr, y_tr)
pred_ridge = model_ridge.predict(X_val)
rmse_ridge = np.sqrt(mean_squared_error(y_val, pred_ridge))
print(f"Ridgeå›å½’ RMSE: {rmse_ridge:.2f}")

# 2. éšæœºæ£®æ—
model_rf = RandomForestRegressor(n_estimators=100, random_state=42)
model_rf.fit(X_tr, y_tr)
pred_rf = model_rf.predict(X_val)
rmse_rf = np.sqrt(mean_squared_error(y_val, pred_rf))
print(f"éšæœºæ£®æ— RMSE: {rmse_rf:.2f}")

# 3. æ±‡æ€»å¯¹æ¯”
print("\n=== æ¨¡å‹æ•ˆæœæ±‡æ€» (RMSE è¶Šå°è¶Šå¥½) ===")
print(f"1. æ™®é€šçº¿æ€§å›å½’: {rmse:.2f}")
print(f"2. Ridge å›å½’:   {rmse_ridge:.2f}")
print(f"3. éšæœºæ£®æ—:     {rmse_rf:.2f}")
```

<img
  src="/static/images/house-prices-advanced-regression-techniques/three_com.png"
  alt="ä¸‰ç§æ¨¡å‹çš„ RMSE è¯¯å·®å¯¹æ¯”ï¼Œæ˜¾ç¤ºéšæœºæ£®æ—æ•ˆæœæœ€å¥½"
  width="700"
/>

**ç»“æœæƒŠäºº**ï¼šéšæœºæ£®æ—å°†è¯¯å·®ä» 6.5 ä¸‡é™åˆ°äº† **2.8 ä¸‡**ï¼è¿™æ˜¯è´¨çš„é£è·ƒã€‚

---

## äº”ã€å¯è§†åŒ–åˆ†æä¸äº§å‡º

æ—¢ç„¶**éšæœºæ£®æ—**æ˜¯å† å†›ï¼Œæˆ‘ä»¬æ¥å‰–æä¸€ä¸‹å®ƒåˆ°åº•å­¦åˆ°äº†ä»€ä¹ˆã€‚

> **ğŸ’¡ å¯è§†åŒ–åŸç†**ï¼š
>
> - **ç‰¹å¾é‡è¦æ€§**ï¼šå‘Šè¯‰æˆ‘ä»¬å“ªäº›å› ç´ æœ€èƒ½å†³å®šæˆ¿ä»·ï¼ˆæ˜¯é¢ç§¯ï¼Ÿè¿˜æ˜¯åœ°æ®µï¼Ÿï¼‰ã€‚
> - **é¢„æµ‹æ•£ç‚¹å›¾**ï¼šæ¨ªè½´æ˜¯çœŸå®å€¼ï¼Œçºµè½´æ˜¯é¢„æµ‹å€¼ã€‚å¦‚æœæ¨¡å‹å®Œç¾ï¼Œæ‰€æœ‰ç‚¹åº”è¯¥è½åœ¨å¯¹è§’çº¢çº¿ä¸Šã€‚

```python
import matplotlib.pyplot as plt
import seaborn as sns

# è®¾ç½®ä¸­æ–‡å­—ä½“ï¼Œé˜²æ­¢ä¹±ç 
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

print("\n--- å¯è§†åŒ–åˆ†æ ---")

# 1. è·å–ç‰¹å¾é‡è¦æ€§
importances = model_rf.feature_importances_
feature_names = X_train.columns
feature_imp_df = pd.DataFrame({'Feature': feature_names, 'Importance': importances})
feature_imp_df = feature_imp_df.sort_values(by='Importance', ascending=False).head(20)

# 2. ç»˜å›¾ï¼ˆå¹¶æ’æ˜¾ç¤ºé€»è¾‘éœ€åœ¨ Web å‰ç«¯å¤„ç†ï¼Œè¿™é‡Œåˆ†åˆ«ç”Ÿæˆï¼‰
# å›¾1ï¼šç‰¹å¾é‡è¦æ€§æ¡å½¢å›¾
plt.figure(figsize=(10, 6))
sns.barplot(x='Importance', y='Feature', data=feature_imp_df, palette='viridis')
plt.title('å½±å“æˆ¿ä»·çš„ Top 20 å…³é”®å› ç´  (éšæœºæ£®æ—)')
plt.xlabel('é‡è¦æ€§æƒé‡')
# plt.show()

# å›¾2ï¼šçœŸå®å€¼ vs é¢„æµ‹å€¼
plt.figure(figsize=(8, 8))
plt.scatter(y_val, pred_rf, alpha=0.5)
plt.plot([min(y_val), max(y_val)], [min(y_val), max(y_val)], color='red', linestyle='--')
plt.xlabel('çœŸå®æˆ¿ä»·')
plt.ylabel('é¢„æµ‹æˆ¿ä»·')
plt.title('çœŸå®å€¼ vs é¢„æµ‹å€¼ (è¶Šæ¥è¿‘çº¢çº¿è¶Šå¥½)')
# plt.show()
```

<div style={{ display: 'flex', justifyContent: 'space-between' }}>
  <img
    src="/static/images/house-prices-advanced-regression-techniques/barchart.png"
    alt="ç‰¹å¾é‡è¦æ€§æ¡å½¢å›¾ï¼Œæ˜¾ç¤º OverallQual å’Œ GrLivArea æ˜¯æœ€é‡è¦çš„ç‰¹å¾"
    style={{ width: '48%' }}
  />
  <img
    src="/static/images/house-prices-advanced-regression-techniques/linechart.png"
    alt="é¢„æµ‹å€¼ä¸çœŸå®å€¼å¯¹æ¯”æ•£ç‚¹å›¾ï¼Œæ•°æ®ç‚¹ç´§å¯†å›´ç»•åœ¨çº¢è‰²å¯¹è§’çº¿å‘¨å›´"
    style={{ width: '48%' }}
  />
</div>

æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨è®­ç»ƒå¥½çš„éšæœºæ£®æ—æ¨¡å‹ï¼Œå¯¹æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹ï¼Œç”Ÿæˆ Kaggle æäº¤æ–‡ä»¶ã€‚

```python
print("\n--- é¡¹ç›®è¾“å‡ºï¼šç”Ÿæˆæäº¤æ–‡ä»¶ ---")

# 1. å¯¹æµ‹è¯•é›†è¿›è¡Œæœ€ç»ˆé¢„æµ‹
final_predictions = model_rf.predict(X_test)

# 2. æ„å»ºæäº¤çš„ DataFrame
submission = pd.DataFrame({
    "Id": test_id,
    "SalePrice": final_predictions
})

# 3. ä¿å­˜
submission.to_csv('submission.csv', index=False)
print("æ­å–œï¼'submission.csv' æ–‡ä»¶å·²ç”Ÿæˆã€‚")
```

æ­å–œï¼ä½ å·²ç»å®Œæˆäº†ä¸€ä¸ªå®Œæ•´çš„æœºå™¨å­¦ä¹ é¡¹ç›®æµç¨‹ã€‚ä»æ¸…æ´—æ‚ä¹±çš„æ•°æ®ï¼Œåˆ°è®­ç»ƒå‡ºé«˜ç²¾åº¦çš„ AI æ¨¡å‹ï¼Œè¿™æ­£æ˜¯æ•°æ®ç§‘å­¦å®¶çš„æ ¸å¿ƒå·¥ä½œã€‚
