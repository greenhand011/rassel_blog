---
title: '【硬核干货】不仅要找漏洞，还要给漏洞打分：DREAD 模型与 IoT 常见杀招'
date: '2025-12-29'
tags: ['IoT Security']
draft: false
summary: '找到了威胁只是第一步，如何判断哪个漏洞更致命？本文详解 DREAD 评分系统，并盘点信号干扰、重放攻击等 IoT 领域的“常见杀招”。'
---

在上一篇文章中，我们利用 **STRIDE** 模型和**攻击树**把医疗输液泵扒了个底朝天，找出了几十个潜在的威胁。
但是，问题来了：**威胁这么多，先修哪一个？**

如果你把所有资源都用来修复一个“很难复现且后果不严重”的漏洞，而忽略了旁边那个“小学生都能利用且能致人死亡”的漏洞，那就是严重的战略失误。

今天，我们将完成《威胁建模》这一章的最后旅程：学习如何给威胁打分（**DREAD** 模型），并盘点一下 IoT 领域最经典的几种攻击手段。

## 一、 谁更致命？用 DREAD 模型给威胁算个命

威胁本身并不可怕，可怕的是它造成的后果。为了科学地排优先级，我们需要一个量化系统。这就是 **DREAD** 评分模型。

DREAD 是五个单词的首字母缩写，每个维度打 0-10 分，最后取平均值。

| 维度  | 英文全称            | 含义           | 高分 (10分) 意味着...            |
| :---- | :------------------ | :------------- | :------------------------------- |
| **D** | **Damage**          | **破坏力**     | 造成生命损失、极大的经济损失     |
| **R** | **Reproducibility** | **复现难度**   | 随便谁、随时随地都能复现         |
| **E** | **Exploitability**  | **利用难度**   | 只要会用浏览器的脚本小子就能攻击 |
| **A** | **Affected Users**  | **受影响用户** | 所有用户都会受到影响             |
| **D** | **Discoverability** | **发现难度**   | 漏洞显而易见，不用挖掘           |

### 实战算分：那个 4 位数的 PIN 码

还记得我们在输液泵限制性界面 (RUI) 发现的那个“弱 PIN 码”漏洞吗？让我们用 DREAD 给它打个分：

<img
  src="/static/images/IOT/dread_table.png"
  alt="Table 2-1: DREAD Scoring Matrix showing the risk calculation"
  width="700"
/>
*(图注：DREAD 评分矩阵示例。我们可以看到这个漏洞的综合得分高达 8 分，属于高危漏洞。)*

1.  **Damage (5分)**：攻击者可以访问当前病人的数据。虽然严重，但通常只影响单个病人，所以给一半分。
2.  **Reproducibility (10分)**：输入 4 个数字谁不会？极其容易复现。
3.  **Exploitability (10分)**：不需要写代码，不需要特殊硬件，利用难度极低。
4.  **Affected Users (5分)**：一次攻击通常只针对当前连接的那台泵的一个病人。
5.  **Discoverability (10分)**：看到 PIN 码输入框，是个黑客都会想试试“1234”或“0000”。

**最终得分**：(5+10+10+5+10) / 5 = **8**。
结论：**必须立即修复！**

```python
# 一个简单的 DREAD 计算器脚本
def calculate_dread(threat_name, d, r, e, a, disc):
    score = (d + r + e + a + disc) / 5
    print(f"威胁名称: {threat_name}")
    print(f"风险评分: {score}/10")
    if score >= 8:
        print(">> 评级: 严重 (Critical) - 立即修复")
    elif score >= 5:
        print(">> 评级: 高 (High) - 尽快修复")
    else:
        print(">> 评级: 中/低 (Medium/Low) - 排期修复")

calculate_dread("Weak PIN Authentication", 5, 10, 10, 5, 10)
```

---

## 二、 换个角度看世界：其他的建模流派

虽然本文主要使用“以软件为中心”的 STRIDE，但作为安全专家，你得知道还有其他流派：

### 1. 以资产为中心 (Asset-Centric)

这种方法不问“怎么攻”，而是问“**我们要保卫什么？**”。
在输液泵场景中，资产包括：

- 病人数据（隐私）
- 控制服务器的认证凭据（钥匙）
- 输液泵的配置参数（生命安全）

### 2. 以攻击者为中心 (Attacker-Centric)

这种方法通过分析“**谁想搞我？**”来建立画像。英特尔有一个很有趣的“威胁代理库”（Intel Threat Agent Library），列出了典型的攻击者画像：

- **无知的护士 (Untrained Nurse)**：操作失误导致系统崩溃。
- **鲁莽的护士 (Reckless Nurse)**：为了省事，绕过安全检查。
- **医院小偷 (Hospital Thief)**：偷硬盘或 SD 卡卖钱。
- **数据矿工 (Data Miner)**：网上扫段，抓取有价值数据。
- **国家级黑客 (Government Cyber Warrior)**：为了制造社会混乱，大规模瘫痪国家医疗设施。

### 3. 其他不明觉厉的缩写

如果你在安全会议上听到别人装 X，提到以下名词，不要慌，它们也是建模框架：

- **PASTA** (攻击模拟与威胁分析过程)
- **Trike**
- **OCTAVE**
- **VAST**
- **Persona non Grata**

---

## 三、 IoT 领域的“七大杀招” (Common IoT Threats)

威胁建模不仅仅是纸上谈兵。在长期的 IoT 攻防实战中，我们总结出了一套“常见威胁清单”。对于绝大多数 IoT 设备，这些攻击一抓一个准。

### 1. 信号干扰 (Signal Jamming)

IoT 设备极其依赖无线通信（Wi-Fi, Zigbee, 蓝牙）。

- **攻击方式**：使用干扰器切断输液泵和服务器的连接。
- **后果**：在危急时刻，医生无法远程停止过量的药物注射。**这是致命的。**

### 2. 重放攻击 (Replay Attacks)

这是最经典的通信协议漏洞。

- **原理**：黑客截获了一段正常的无线指令（例如：“注射 5mg 吗啡”），然后像复读机一样把这段指令重新发给设备。
- **后果**：病人可能会收到双倍、三倍甚至无数倍的药量。
- **防御**：必须在数据包里加时间戳或随机数（Nonce）。

### 3. 设置篡改 (Settings Tampering)

- **攻击方式**：修改设备的 DNS 设置，或者把控制服务器的 IP 地址改成黑客自己的服务器。
- **后果**：设备向黑客汇报数据，甚至接受黑客的恶意指令。

### 4. 硬件完整性攻击 (Hardware Integrity Attacks)

- **攻击方式**：撬开锁，插上 USB，或者直接从电路板上读取数据。
- **猫鼠游戏**：有些厂商设计了“熔断机制”——一旦外壳被打开，电路板上的保险丝就会熔断，销毁密钥。
- **现实**：黑客总能找到绕过方法。书里提到一次经历：厂商确实设计了熔断保护，但研究人员最后还是绕过了它。**只要设备在黑客手里，就没有绝对的安全。**

### 5. 节点克隆 (Node Cloning / Sybil Attack)

- **攻击方式**：黑客伪造了一个假的“输液泵”节点，加入到医院的网络中。
- **后果**：这个假节点可以发送虚假的病人数据，或者发起拒绝服务攻击。原因往往是入网协议太简单，没有严格的证书认证。

### 6. 安全与隐私泄露 (Security and Privacy Breaches)

- **现状**：这是 IoT 最大的顽疾。几乎所有的通信协议都在泄露点什么。
- **做法**：哪怕数据加密了，通过分析流量大小和频率（元数据），也能推断出病人什么时候在用药。

### 7. 用户的安全意识 (User Security Awareness)

最后，也是最难防御的——**人**。

- **经典语录**：“如果你想找一个业务逻辑漏洞，或者想知道怎么绕过某个繁琐的流程，**去问问负责操作的护士吧**。”
- **原因**：护士每天要操作这套系统几百次，为了省事（或者救急），他们一定知道所有的快捷键和绕过密码的方法。黑客只需要社会工程学一下。

---

## 总结：威胁建模的意义

本章带我们走完了威胁建模的全流程：

1.  画出架构图，拆解组件。
2.  画出数据流和信任边界。
3.  用 **STRIDE** 识别威胁。
4.  用 **攻击树** 理清攻击路径。
5.  用 **DREAD** 给风险打分。

这个过程可能看起来很繁琐，但它是安全基石。正如文中总结所说：“这种方法可能不适合所有情况，但它为你提供了一个基准。”

现在，脑子里的演习结束了。在下一章，我们将正式进入技术深水区，开始真正的 **漏洞挖掘与分析**。准备好你的调试器了吗？

```python
# 课后作业：
# 观察你身边的“智能门锁”。
# 1. 它的“重放攻击”风险是多少？（它有防重放机制吗？）
# 2. 如果我想给它的威胁打分，DREAD 中的 "Damage" 应该是多少？（进家里偷东西 vs 只是打不开门）
```
